## 1. 관계 데이터 모델의 개념

#### 1. 릴레이션

릴레이션 : 행과 열로 구성된 테이블  
ex) 도서  
| 도서번호 | 도서이용 | 출판사 | 가격 |
| --- | --- | --- | --- |
| 1 | 축구의 역사 | 굿스포츠 | 7000 |
| 2 | 축구아는 여자 | 나무수 | 13000 |
| 3 | 축구의 이해 | 대한미디어 | 22000 |
| 4 | 골프 바이브 | 대한미디어 | 35000 |
| 5 | 피겨 교본 | 굿스포츠 | 8000 |

릴레이션은 구학의 집합에서 나온 개념이다.  
위의 도서 릴레이션의 경우 네 개의 집합 도서번호, 도서이름, 출판사, 가격으로 구성되어 있음. 각 집합은 다음과 같은 원소를 갖고 있다.

    도서번호 = {1,2,3,4,5}
    도서이름 = {축구의 역사, 축구아는 여자, 축구의 이해, 골프 바이블, 피겨 교본}
    출판사 = {굿스포츠, 나무수, 대한미디어}
    가격 = {7000, 13000, 22000, 35000, 8000}

#### 2. 릴레이션 스키마와 인스턴스

릴레이션은 아래 두가지로 구성된다

-   스키마 : 관게 데이터베이스의 릴레이션이 어떻게 구성되는지 어떤 정보를 담고 있는지에 대한 기본적인 구조를 정의한다. 테이블에서 스키마는 테이블의 첫 행인 헤더에 나타나며 각 데이터의 특징을 나타내는 속성, 자료 타입 등의 정보를 담고 있다.
-   인스턴스 : 정의된 스키마에 따라 테이블에 실제로 저장되는 데이터의 집합을 의미한다.
    ex)

| 도서번호 | 도서이용      | 출판사     | 가격  |
| -------- | ------------- | ---------- | ----- |
| 1        | 축구의 역사   | 굿스포츠   | 7000  |
| 2        | 축구아는 여자 | 나무수     | 13000 |
| 3        | 축구의 이해   | 대한미디어 | 22000 |
| 4        | 골프 바이브   | 대한미디어 | 35000 |
| 5        | 피겨 교본     | 굿스포츠   | 8000  |

첫 행(도서번호, 도서이용, 출판사, 가격) : attribute,column -> schema 내포  
1~5 : tuple / row -> 인스턴스

속성 : 릴레이션 스키마의 열  
도메인 : 속성이 가질 수 있는 값의 집합  
차수 : 속성의 개수

튜플 : 릴레이션의 행  
카디날리티 : 튜플의 수

#### 3. 릴레이션의 특징

1. 속성은 단일 값을 가진다
2. 속성은 서로 다른 이름을 가진다
3. 한 속성의 값은 모두 같은 도메인 값을 가진다 : 한 속성에 속한 열은 모두 그 속성에서 정의한 도메인 값만 가질 수 있다.
4. 속성의 순서는 상관없다
5. 릴레이션 내의 중복된 튜플은 허용하지 않는다.
6. 튜플의 순서는 상관없다.

#### 4. 관계 데이터 모델

-   관게 데이터 모델 : 데이터를 2차원 테이블 형태인 릴레이션으로 표헌함. 릴레이션에 대한 제약조건과 관계 연산을 위한 관계대수를 정의함.
-   관계 데이터베이스 시스템 : 관계 데이터 모델을 컴퓨터 시스템에 구현한 것.
    -   관계 데이터베이스 시스템은 관계 데이터 모델에 기초하여 SQL을 기반으로 구현 됨.

## 2. 무결성 제약조건

#### 1. 키

-   키 : 릴레이션에서 특정 튜플을 식별할 때 사용하는 속성 혹은 속성의 집합.

    -   키는 각 릴레이션의 튜플을 유일하게 식별하는 장치이며 동시에 각 릴레이션 간의 관계를 말해주는 연결고리.

-   슈퍼키 : 튜플을 유일하게 식별할 수 있는 하나의 속성 혹은 속성의 집합
    ex)
    고객번호 : 고객별로 유일한 값이 부여되어 있기 때문에 튜플을 식별할 수 있음 -> 슈퍼키
    주민번호 : 개인별로 유일한 값이 부여되어 있기 때문에 튜플을 식별할 수 있음 -> 슈퍼키
    이름 : 동명이인이 있을 경우 튜플을 유일하게 식별할 수 없다 -> 슈퍼키 X

-   후보키 : 튜플을 유일하게 식별할 수 있는 속성의 최소 집합.
-   복합키 : 두 개 이상의 속성으올 이루어진 키.

-   기본키 : 여러 후보키 중 하나를 선정하여 대표로 삼는 키. - 후보키가 하나뿐이라면 그 후보키를 기본키로 사용하면 되고 여러 개라면 릴레이션의 특성을 반영하여 하나를 선택하면 됨.
    ex)
    고객 릴레이션
-   주민 번호
    -   장점 : 변경 불가능. 튜플 식별시 자료의 변형에 잘 대처할 수 있음.
    -   단점 : 개인정보가 포함되어 있어 개인정보 보호에는 취약.
    -   결론 : 기본키 사용하기에는 부담이 있음.
-   고객 번호

    -   주민 번호의 단점이 없으므로 기본키로 상요 가능.

-   기본키 선정 시 고려사항

    -   릴레이션 내 튜플을 식별할 수 있는 고유한 값을 가져야 한다.
    -   NULL 값은 허용하지 않는다.
    -   키 값의 변동이 일어나지 않아야 한다.
    -   최대한 적은 수의 속성을 가진 것이라야 한다.
    -   향후 키를 사용하는 데 있어서 문제 발생 소지가 없어야 한다.

-   대리키

    -   기본키가 보안을 요하거나, 여러 개의 속성으로 구성되어 복잡하거나, 마땅한 기본키가 없을때는 일련번호 같은 가상의 속성을 만들어 기본키로 사용하는 키.
    -   대리키는 DBMS나 관련 소프트웨어에서 임의로 생성하는 값을 사용자가 직관적으로 그 값의 의미를 알 수 없다.

-   대체키

    -   기본키로 선저오디지 않은 후보키.

-   외래키
    -   다른 릴레이션의 기본키를 참조하는 속성.
    -   다른 릴레이션의 기본키를 참조하여 관계 데이터 모델의 특징인 릴레이션 간의 관계를 표현함.
    -   특징
        -   관계 데이터 모델의 릴레이션 간의 관계를 표현.
        -   다른 릴레이션의 기본키를 참조하는 속성.
        -   참조하고 참조되는 양쪽 릴레이션의 도메인은 서로 같아야 한다.
        -   참조되는 값이 변경되면 참조하는 값도 변경된다.
        -   NULL값과 중복 값 등이 허용됨.
        -   자기 자신의 기본키를 참조하는 외래키도 가능.
        -   외래키가 기본키의 일부가 될 수 있다.

#### 2. 무결성 제약 조건

-   데이터 무결성(integrity) : 데이터베이스에 저장된 데이터의 일관성과 정확성을 지키는 것.

    -   데이터베이스가 계속해서 무경성을 유지하려면 튜플의 삽입, 삭제, 수정 시 데이터의 제약조건 준서 여부를 확인하여야 함.

-   도메인 무결성 제약조건 : 릴레이션 내의 튜플들이 각 속성의 도메인에 지정된 값만을 가져야 한다는 조건.
    -   데이터 형식, NULL, 기본 값, 체크 등을 사용하여 지정 가능.
-   개체 무결성 제약 조건(기본키 제약) : 기본키는 NULL값을 가져서는 안 되며 릴레이션 내에 오직 하나의 값만 존재해야 한다는 조건.
-   참조 무결성 제약 조건(외래키 제약) : 자식 릴레이션의 외래키는 부모 릴레이션의 기본키와 도메인이 동일해야 하며, 자식 릴레이션의 값이 변경될 때 부모 릴레이션의 제약을 받는가는 것.

#### 3. 무결성 제약조건의 수행

-   릴레이션은 데이터의 변경이 일어날 때 제약조건에 위배될 수 있다. -> 제약 조건의 준수 여부는 삽입,수정,삭제가 있을 때마다 확인해야 함.

-   개체 무결성 제약조건
    -   DBMS는 튜플을 삽입하거나 수정할 때마다 개체 무결성 제약 조건을 지키는지 확인한다. : 기본키 값이 유일한지, NULL 값이 아닌지를 검사함.
        ex) 학생
        | 학번 | 이름 | 학과코드 |
        | --- | --- | --- |
        | 501 | 박지성 | 1001 |
        | 401 | 김연아 | 2001 |
        | 402 | 장미란 | 2001 |
        | 502 | 추신수 | 1001 |

1.  삽입
    -   (501, 남슬찬, 1001) -> 개체 무결성 제약조건을 수행하기 위해 학생 릴레이션 체크 -> 학번에 501 존재 -> 삽입 거부
    -   (NULL, 남슬찬, 1001) -> 기본키로 NULL이 들어온거 체크 -> 삽입 거부
2.  수정
    -   삽입 연산과 동일한 제약에 따라 처리됨.
3.  삭제
    -   특별 확인 X -> 즉시 수행
    -   단, 참조 무결성 제약조건에 의하여 학생 릴레이션의 기본키를 다른 릴레이션에서 외래키로 참조하고 있으면 바로 삭제 안함.

-   참조 무결성 제약조건

    -   참조 무결성 제약조건은 두 릴레이션 간의 참조 관계에 따라 좀 더 복잡한 처리를 수행해야 함.
        ex)

    학생(자식 릴레이션)
    | 학번 | 이름 | 학과코드 |
    | --- | --- | --- |
    | 501 | 박지성 | 1001 |
    | 401 | 김연아 | 2001 |
    | 402 | 장미란 | 2001 |
    | 502 | 추신수 | 1001 |

    학과(부모 릴레이션)
    | 학과코드 | 학과명 |
    | --- | --- |
    | 1001 | 컴퓨터학과 |
    | 2001 | 체육학과 |

1. 삽입
    - 학생에 새로운 튜플 (601, 박세리, 3001) 삽입
        - DBMS에서 도메인 무결성 제약조건을 확인 후 개체 무결성 제약조건에 위배되는 값이 없는지 확인.
        - 학과코드 값 3001이 학과 릴레이션의 기본키에 존재하는지 확인.
        - but 3001은 학과 릴레이션에 없으므로 삽입 거부.
            - 이 때 학과 릴레이션에 새로운 튜플 (3001, 수학과)를 삽입한 후 수행하면 정상적으로 수행됨.
2. 삭제
    - 자식 릴레이션에서 튜플이 삭제되는 경우 부모 릴레이션에는 아무런 영향을 주자 않으므로 바로 삭제 됨.
    - 부모 릴레이션에서 튜플이 삭제되는 경우 문제 발생할 수 있음.
        - 학과 릴레이션에서 체육학과를 삭제해야 하는 경우 우선 학과 릴레이션의 학과코드를 참조하고 있는 다른 릴레이션이 없는지 찾는다.
        - 이 경우 학생 릴링션의 (401, 김연아, 2001), (402, 장미란, 2001)이 참조하고 있으므로 문제가 생긴다.
        - 조치 방법
            - 즉시 작업을 중지
            - 자식 릴레이션의 관련 튜플을 삭제
            - 초기에 설정된 다른 어떤 값으로 변경
            - NULL 값으로 설정

-   참조 무결셩 제약조건의 옵션
    -   RESTRICTED
        -   자식 릴레이션에서 참조하고 있을 경우 부모 릴레이션의 삭제 작업을 거부.
    -   CASCADE
        -   자식 릴레이션의 관련 튜플을 같이 삭제.
    -   DEFAULT
        -   자식 릴레이션의 관련 튜플을 미리 설정해둔 값으로 변경.
    -   NULL
        -   자식 릴레이션의 관련 튜플을 NULL값으로 설정.

3. 수정
    - 삭제와 삽입 명령이 연속해서 수행.
        - 삭제 옵션에 따라 처리
        - 삽입 제약 조건에 따라 처리.
